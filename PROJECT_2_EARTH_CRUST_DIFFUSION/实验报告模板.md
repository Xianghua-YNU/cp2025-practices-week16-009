# 项目2：地壳热扩散数值模拟 - 实验报告

**学生姓名：** [杨万超]

**学号：** [20231050093]

**完成日期：** [2025.6.11]


---

## 1. 实验目的

本实验旨在通过数值方法求解地壳中的热传导方程，深入理解以下概念：

- 时变边界条件对热传导过程的影响
- 显式差分格式的稳定性和精度特点
- 地球科学中的热传导现象

**核心学习目标：**
1. 掌握显式差分格式求解抛物型偏微分方程
2. 理解季节性温度变化在地壳中的传播规律

---

## 2. 理论背景

### 2.1 热传导方程

地壳中的一维热传导方程为：

$$\frac{\partial T}{\partial t} = D \frac{\partial^2 T}{\partial z^2}$$

其中：
- $T(z,t)$ 是温度分布函数
- $z$ 是深度坐标（向下为正）
- $t$ 是时间
- $D$ 是热扩散率

### 2.2 边界条件和初始条件

**边界条件：**
- 地表 ( $z=0$ )： $T(0,t) = A + B\sin(\frac{2\pi t}{\tau})$
- 深层 ( $z=20\text{m}$ )： $T(20,t) = 11°\text{C}$

**初始条件：**
- $T(z,0) = 10°\text{C}$ （除边界点外）

**物理参数：**
- $D = 0.1 \text{ m}^2/\text{day}$ （热扩散率）
- $A = 10°\text{C}$ （年平均地表温度）
- $B = 12°\text{C}$ （地表温度振幅）
- $\tau = 365 \text{ days}$ （年周期）


## 3. 数值方法简述

### 3.1 显式差分格式(或者你采取的其他算法)

**请描述你实现的差分算法的具体形式和求解方法：**

在本实验中，我们使用显式差分格式对热传导方程进行求解。空间和时间的离散化方案如下：
- 空间步长 $h=1.0$ m，深度方向网格点数 $M=21$（包括0到20米的21个点）。
- 时间步长通过稳定性条件进行选择，相应的时间步数 
（以天为单位，模拟一年）。
差分方程的形式为：
$$T_{i,j+1} = T_{i,j} + r \cdot (T_{i+1,j} + T_{i-1,j} - 2T_{i,j})$$

其中 $r = \frac{hD}{\Delta t}$ 是稳定性参数。


**稳定性分析：**

- 稳定性参数 $r = \frac{hD}{a^2}$ 的值
- 时间步长选择的限制条件
为确保显式格式的稳定性，选择合适的时间步长需满足条件 $r \leq 0.5$ 。在本实验中，我们通过调整时间步长 $\Delta t$ 满足此条件。
---

## 4. 实验结果

### 4.1 数值结果

**基本计算参数：**
- 网格点数: $n_z$ =  [21]
- 时间步数: $n_t$ =  [3660]
- 模拟总时间：[10] 年
- 稳定性参数: $r$ =  [0.100]

### 4.2 图表结果：季节性温度轮廓图

![image](https://github.com/user-attachments/assets/061e4ccb-c59b-4197-9969-d49e2676b498)


**图表分析：**
- 温度轮廓展示了四个季节的温度分布，表明随着深度的增加，季节性温度的振幅逐渐减小，显示了地表温度对深层温度影响的衰减过程。
- 温度的相位延迟显著，深层温度的响应滞后于地表温度变化，表明热传导过程的延时特性。
---

## 5. 分析与讨论

### 5.1 物理现象分析

**地壳热传导特征：**

模拟结果表明，地壳中的温度随着深度的增加而稳定，阐明了热扩散的特性，以及地表温度的季节性变化在深层的影响逐渐减弱的规律。尽管地表温度随季节变化明显，但20米深度的温度变化幅度远小于表层。


### 5.2 思考题

**请回答以下问题：**

1. **为什么深层温度的季节性变化比地表小得多？这种现象在实际地球科学中有什么应用？**

   深层温度的季节性变化较小是由于热传导的缓慢过程和深层的热储存特性，深层对地表温度变化的响应滞后到达地表温度变化的影响尚需要时间。这种现象在地热能开发、地下水温度监测等领域具有实际应用意义。

3. **显式差分格式相比隐式格式有什么优势？在什么情况下可能选择隐式格式？**

   显式差分格式实现简单、计算量小，但对时间步长要求严苛，稳定性较差。而隐式格式尽管实现复杂且计算量大，但在时间步长选择上更为灵活。对于需要较大时间步长或在处理刚性问题时，通常选择隐式格式。


---

## 6. 核心代码片段（可选）

```python
def solve_earth_crust_diffusion(h=1.0, a=1.0, M=21, N=366, years=10):
    # 计算稳定性参数
    r = h * D / a**2
    print(f"稳定性参数 r = {r:.4f}")
    
    # 初始化温度矩阵
    T = np.zeros((M, N)) + T_INITIAL
    T[-1, :] = T_BOTTOM  # 底部边界条件
    
    # 时间步进循环
    for year in range(years):
        for j in range(1, N-1):
            # 地表边界条件
            T[0, j] = A + B * np.sin(2 * np.pi * j / TAU)
            
            # 显式差分格式
            T[1:-1, j+1] = T[1:-1, j] + r * (T[2:, j] + T[:-2, j] - 2*T[1:-1, j])
    
    # 创建深度数组
    depth = np.arange(0, DEPTH_MAX + h, h)
    
    return depth, T


def plot_seasonal_profiles(depth, temperature, seasons=[90, 180, 270, 365]):
    for i, day in enumerate(seasons):
        plt.plot(depth, temperature[:, day], 
                label=f'Day {day}', linewidth=2)
    plt.xlabel('Depth (m)')
    plt.ylabel('Temperature (°C)')
    plt.title('Seasonal Temperature Profiles')
    plt.grid(True)
    plt.legend()
    
    plt.show()


if __name__ == "__main__":
    # 运行模拟
    depth, T = solve_earth_crust_diffusion()
    
    # 绘制季节性温度轮廓
    plot_seasonal_profiles(depth, T)

```

